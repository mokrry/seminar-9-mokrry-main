## Решения задач использую встроенные функции PostgreSQL

## Задания

### Задание 1. Математические операции со строками

**Цель:** Научиться использовать функции для работы со строками и комбинировать их с математическими операциями.

**Описание задания:**
Дана таблица `demographics` со следующей структурой:

* id
* name
* birthday
* race

Верните одну колонку с названием `calculation`, где значение равно битовой длине поля name, сложенной с количеством
символов в поле race.

**Ответ:**

```sql
SELECT
  bit_length(name) + char_length(race) AS calculation
FROM demographics;
```

### Задание 2. Битовая длина строк

**Цель:** Освоить функции для работы с битовым представлением строк.

**Описание задания:**
Дана таблица demographics со следующей структурой:

* id
* name
* birthday
* race

Необходимо вернуть ту же таблицу, где все текстовые поля (name и race) заменены на битовую длину строки.

**Ответ:**

```sql
SELECT
  id,
  bit_length(name) AS name,
  birthday,
  bit_length(race) AS race
FROM demographics;
```

### Задание 3. Преобразование в ASCII

**Цель:** Познакомиться с функциями преобразования строк в ASCII-коды.

**Описание задания:**
Дана таблица demographics со следующей структурой:

* id
* name
* birthday
* race

Требуется вернуть ту же таблицу, где все текстовые поля (name и race) заменены на ASCII-код их первого байта.
Например: Verlie = 86, Warren = 87, Horace = 72, Tracy = 84

**Ответ:**

```sql
SELECT
  id,
  ascii(name) AS name,
  birthday,
  ascii(race) AS race
FROM demographics;
```

### Задание 4. Конкатенация столбцов

**Цель:** Научиться объединять данные из нескольких столбцов.

**Описание задания:**
Дана таблица names со следующей структурой:

* id
* prefix
* first
* last
* suffix

Ваша задача - использовать оператор SELECT для создания таблицы с одним столбцом, содержащим полное имя человека (
конкатенация всех столбцов, кроме id), следующим образом:

Вернуть нужно:

* title

Не забудьте добавить пробелы между частями имени.

**Ответ:**

```sql
SELECT
  concat_ws(' ', prefix, first, last, suffix) AS title
FROM names;
```

### Задание 5. Шифрование с выравниванием

**Цель:** Научиться манипулировать строками для выравнивания их длины.

**Описание задания:**
Вам дана таблица со следующей структурой:

* md5
* sha1
* sha256

Проблема в том, что таблица выглядит несбалансированной - столбец sha256 содержит гораздо более длинные строки. Вам
нужно сбалансировать их. Добавьте '1' в конец адресов md5 столько раз, сколько нужно, чтобы они имели такую же длину,
как в столбце sha256. Добавьте '0' в начало значений sha1, чтобы достичь того же результата.

**Ответ:**

```sql
SELECT
  rpad(md5, length(sha256), '1')  AS md5,
  lpad(sha1, length(sha256), '0') AS sha1,
  sha256
FROM encryption;
```

### Задание 6. Функции RIGHT и LEFT

**Цель:** Освоить функции для извлечения подстрок с начала и конца строки.

**Описание задания:**
Вам дана таблица с названием repositories, структура которой приведена ниже:
Структура таблицы repositories:

* project
* commits
* contributors
* address

Таблица показывает названия проектов основных криптовалют, количество их коммитов и участников, а также случайный адрес
для пожертвований (не связанный каким-либо образом).

Для каждой строки:

Верните первые x символов названия project, где x = количество commits.
Верните последние y символов каждого address, где y = количество contributors.

Верните только столбцы project и address. Регистр символов должен быть сохранен.

**Ответ:**

```sql
SELECT
  left(project, commits) AS project,
  right(address, contributors) AS address
FROM repositories;
```

### Задание 7. Замена с помощью регулярных выражений

**Цель:** Научиться использовать регулярные выражения для манипуляций с текстом.

**Описание задания:**
Вам дана таблица с названием repositories, структура которой приведена ниже:
Структура таблицы repositories:

* project
* commits
* contributors
* address

Таблица показывает названия проектов основных криптовалют, количество их коммитов и участников, а также случайный адрес
для пожертвований.
Ваша задача - удалить все цифры в столбце address и заменить их на '!', затем вернуть таблицу

**Ответ:**

```sql
SELECT
  project,
  commits,
  contributors,
  regexp_replace(address, '[0-9]', '!', 'g') AS address
FROM repositories;
```

### Задание 8. Реальная цена!

**Цель:** Научиться выполнять расчеты в запросах и форматировать результаты.

**Описание задания:**
Вы являетесь владельцем продуктового магазина. Все ваши товары находятся в базе данных.
Покупателям часто нужно знать, сколько на самом деле они платят за продукты. Производители делают разные размеры одного
и того же продукта, поэтому сложно сравнивать цены; иногда они делают упаковки большими, но вес продукта маленький.
Создайте запрос SELECT, который будет показывать цену за кг продукта.
Вес указан в граммах! Округлите price_per_kg до 2 десятичных знаков.
Отсортируйте результаты по price_per_kg по возрастанию, затем по name по возрастанию.
Структура таблицы products:

* id (int)
* name (string)
* price (float)
* stock (int)
* weight (float)
* producer (string)
* country (string)

Вернуть нужно:

* name (string)
* weight (float)
* price (float)
* price_per_kg (float)

**Ответ:**

```sql
SELECT
  name,
  weight,
  price,
  round((price * 1000 / weight)::numeric, 2) AS price_per_kg
FROM products
ORDER BY price_per_kg ASC, name ASC;
```